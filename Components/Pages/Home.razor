@page "/"
@using Microsoft.AspNetCore.Identity
@using ProyectoMejorado.Data
@inject NavigationManager Navigation
@inject AuthenticationStateProvider authProvider
@inject UserManager<ApplicationUser> userManager

@code {
    protected override async Task OnInitializedAsync()
    {
        var auth = await authProvider.GetAuthenticationStateAsync();
        var user = await userManager.GetUserAsync(auth.User);

        if (user != null)
        {
            if (await userManager.IsInRoleAsync(user, "Admin"))
            {
                await Task.Yield(); // 👉 Esto permite que la navegación no se dispare prematuramente
                Navigation.NavigateTo("/admin/dashboard");
                return;
            }
        }

        await Task.Yield(); // 👉 Para evitar error de navegación prematura
        Navigation.NavigateTo("/tienda");
    }
}
